<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tim Kerr">

<title>../../PhD_Blog - Plan for March</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PhD_Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Plan for March</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tim Kerr </p>
            </div>
    </div>
      
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="progress-thus-far" class="level3">
<h3 class="anchored" data-anchor-id="progress-thus-far">Progress Thus Far</h3>
<p>I have a set of data I can work with.</p>
<p>I have built variants of a reinforcement learning model in Stan.</p>
<p>This model works, appears to extract individual differences in parameters, generates data, and offers an information criterion.</p>
<p>I have correlated estimated parameters to phenotype data, and run a frequentist significance test.</p>
</section>
<section id="problems" class="level3">
<h3 class="anchored" data-anchor-id="problems">Problems</h3>
<p>The data are untidy, and I cannot make inferences from them. It is not discretised to individual studies. There are missing data such as scream patterns and CS+/CS- orders.</p>
<p>The models built are complex, have many parameters, and require some significant data transformations.</p>
<p>The models don’t work well, they are rigid. They do not capture much of the volatility in the data. The generated data distributions are uninformative. The information criterions are bonkers, preventing me from comparing models.</p>
<p>A Bayesian significance test should be used given the model. In addition, null models and other sanity checks should be used.</p>
</section>
<section id="the-correct-pipeline-per-the-literature" class="level3">
<h3 class="anchored" data-anchor-id="the-correct-pipeline-per-the-literature">The Correct Pipeline per the Literature</h3>
<p>Referencing this Wilson &amp; Collins (2019) <a href="https://elifesciences.org/articles/49547">paper</a></p>
<ol type="1">
<li><p>Theorise a set of models which all have a chance to realistically capture the data. This can include null models such as random button pressing. (Also just fit a curve)</p></li>
<li></li>
</ol>
<ol type="i">
<li><p>Simulate data. Using the models, set the free parameters via a random choice from a distribution, and generate simulated data. Then run this data back through the model, to see if it can <strong>recover</strong> the parameters correctly. Do this several times iteratively, to see if the models can cope with many parameter settings, which is indicative that they can actually estimate free parameters from real data. (Run a KL divergance score here?)</p></li>
<li><p>Plot the correlation between real and recovered parameters, looking for a correlation above a certain level, &gt;0.5 correlation say. Plotting will show biases or areas where there is large divergance.</p></li>
</ol>
<p>nb- some models will only work within certain parameter ranges, so completely random parameters may not work, and might need to be bounded within realistic limits.</p>
<ol start="3" type="1">
<li><p>Compare different models using an information criterion, or cross validation. This can be plotted in a confusion matrix, which validates model comparison via model recovery on simulated data. (Is simulated data from model A best fit by model A, or model B, C etc. per BIC/WAIC). Confusion matrix should be an identity matrix. If not, look into running an inversion matrix.</p></li>
<li><p>Run models with real data. You can further simulate to find biases, such as left/right biases, or optimism biases, which affect choice above basic model. Validation should be via a posterior predictive check, i.e.&nbsp;by simulating data with the fit parameter values. This leads to a winning model.</p></li>
<li><p>Extract latent variables from the model. These can be correlated with physiological data, especially their evolution over time. You can also study individual differences, using fit parameters as dependent variable in continuous analyses, correlating with age or symptoms, or group comparisons.</p></li>
</ol>
</section>
<section id="learning-still-to-do" class="level3">
<h3 class="anchored" data-anchor-id="learning-still-to-do">Learning Still to do</h3>
<p>Log Likelihood and model comparisons therein. I still don’t quite understand exactly what this is measuring, and hence why the model comparisons aren’t working. I have found a lecture <a href="https://github.com/rmcelreath/stat_rethinking_2023">series</a> which explains this in more detail than Lei Zhang’s course.</p>
<p>Dirichlet distributions for discrete data. I think this is a better fit for the experiment than a beta distribution alone. This tutorial might explain <a href="https://www.alexpghayes.com/post/2018-12-24_some-things-ive-learned-about-stan/">things</a></p>
</section>
<section id="relevant-papers" class="level3">
<h3 class="anchored" data-anchor-id="relevant-papers">Relevant Papers</h3>
<p>Hopkins, A. K., Dolan, R., Button, K. S., &amp; Moutoussis, M. (2021). A Reduced Self-Positive Belief Underpins Greater Sensitivity to Negative Evaluation in Socially Anxious Individuals. Computational Psychiatry, 5(1), 21–37. DOI: http://doi.org/10.5334/cpsy.57 <a href="https://cpsyjournal.org/article/10.5334/cpsy.57/">paper</a> <a href="https://s3-eu-west-1.amazonaws.com/ubiquity-partner-network/up/journal/cpsy/cpsy-5-1-57-s1.PDF">supplement</a></p>
<p>This paper contains beta distributions, and aims to explain anxious participants learning more from negative experiences. Good clear explanations in supplement.</p>
<p>Wise T, Michely J, Dayan P, Dolan RJ (2019) A computational account of threat-related attentional bias. PLoS Comput Biol 15(10): e1007341. https://doi.org/10.1371/journal.pcbi.1007341 <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1007341">paper</a></p>
<p>This paper uses ‘leaky beta distributions’, I think in place of RL. It also examines attentional processes, via a Pierce-Hall adaptation, which might better model decay/boredom.</p>
</section>
<section id="plan" class="level3">
<h3 class="anchored" data-anchor-id="plan">Plan</h3>
<ol type="1">
<li>Build a set of models in R, to simulate data.</li>
</ol>
<ol type="a">
<li>Null - random button pressing</li>
<li>Null - single button pressing</li>
<li>Curve - polynomial regression</li>
<li>RL - RW/Beta two parameters (alpha (LR) and sigma (variance))</li>
<li>RL - RW/Beta three parameters (reward alpha and punishment alpha (LR) and sigma (variance))</li>
<li>RL - RW/Dirichet two parameters</li>
<li>RL - RW/Dirichet three parameters</li>
</ol>
<ol start="2" type="1">
<li><p>Rebuild above in Stan, and compare these models per Wilson paper, including correlations and confusion matrices.</p></li>
<li><p>Make a better real dataset to work from, perhaps going back to source to find correct patterns. :cold_sweat:</p></li>
<li><p>Run the best models with real data.</p></li>
<li><p>Possibly look to pre-register at this point, prior to running correlations with phenotype data.</p></li>
</ol>
</section>
<section id="timeframe" class="level3">
<h3 class="anchored" data-anchor-id="timeframe">Timeframe</h3>
<p>There are no major obstacles or life events in March. I have four relatively clear weeks to do this work, prior to running the Paris Marathon on April 2nd, where I will take a week off post.</p>
<p>This week, i.e.&nbsp;by Friday 3rd, I hope to build the R models.</p>
<p>In the week commencing 6th March, I will rebuild these in Stan, and start model comparisons.</p>
<p>W/C 13th March, I will apply these to the real data, if on schedule.</p>
<p>W/C 20th March, I will continue to apply these to real data.</p>
<p>W/C 27th March, I will write up the pre-registration.</p>
<p>Longer term, I hope to present results in June, and a poster in July.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>